configure_dynamic_loader = $(if $(call equal?,$(linkage),dynamic),LD_LIBRARY_PATH=$$(build_libraries_directory))

define generate_run_example_rule
phony_targets += run-$(1)

run-$(1) : $$(build_examples_directory)/$(1)
	$(call configure_dynamic_loader) $$(build_examples_directory)/$(1)
endef

$(foreach example,$(examples),$(eval $(call generate_run_example_rule,$(example))))

undefine generate_run_example_rule
