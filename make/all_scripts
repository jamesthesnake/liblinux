# Project scripts
gcc_specs_script := $(scripts_directory)/$(project).specs.sh
gcc_wrapper_script := $(scripts_directory)/$(project)-gcc.sh

# External scripts
download = curl --output $(1) $(2)
download_linux_script = $(call download,$(1),https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/plain/scripts/$(notdir $(1)))

# Integration with the Linux kernel's checkpatch.pl script
checkpatch.pl := $(scripts_linux_directory)/checkpatch.pl
checkpatch.pl_files := $(addprefix $(dir $(checkpatch.pl)),const_structs.checkpatch spelling.txt)

$(checkpatch.pl): $(checkpatch.pl_files)
	$(call download_linux_script,$@)
	chmod +x $@

$(checkpatch.pl_files):
	$(call download_linux_script,$@)

phony_targets += checkpatch
checkpatch: $(checkpatch.pl)
	find $(include_directory) $(source_directory) $(start_directory) $(examples_directory) \
	     -type f \
	     -exec $(checkpatch.pl) --quiet --no-tree --file {} \;
